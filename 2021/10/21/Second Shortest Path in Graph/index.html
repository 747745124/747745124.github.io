
<!DOCTYPE html>
<html lang="en-us,default" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The 2nd-shortest Path - Niflheimr</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="A personal website for Naoyuki,Date:11.19.2021
Update Log 11.25.2021:Comptability：Known issue has been included in README.md
Recom,"> 
    <meta name="author" content="Naoyuki"> 
    <link rel="alternative" href="atom.xml" title="Niflheimr" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="The 2nd-shortest Path - Niflheimr"/>
    <meta name="twitter:description" content="A personal website for Naoyuki,Date:11.19.2021
Update Log 11.25.2021:Comptability：Known issue has been included in README.md
Recom,"/>
    
    
    
    
    <meta property="og:site_name" content="Niflheimr"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="The 2nd-shortest Path - Niflheimr"/>
    <meta property="og:description" content="A personal website for Naoyuki,Date:11.19.2021
Update Log 11.25.2021:Comptability：Known issue has been included in README.md
Recom,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">Niflheimr</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://naoyuki.top"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">The 2nd-shortest Path</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">The 2nd-shortest Path</h1>
        <div class="stuff">
            <span>十月 21, 2021</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/C-C/" rel="tag">C/C++</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/DataStructure/" rel="tag">DataStructure</a></li></ul>


        </div>
        <div class="content markdown">
            <h4 id="Date-11-19-2021"><a href="#Date-11-19-2021" class="headerlink" title="Date:11.19.2021"></a>Date:11.19.2021</h4><blockquote>
<h3 id="Update-Log-11-25-2021"><a href="#Update-Log-11-25-2021" class="headerlink" title="Update Log 11.25.2021:"></a>Update Log 11.25.2021:</h3><h4 id="Comptability："><a href="#Comptability：" class="headerlink" title="Comptability："></a>Comptability：</h4><p>Known issue has been included in README.md</p>
<p>Recommend to compile with clang++，or Visual Studio 2019 CE.<br>Lab Files has been compiled and reviewed under MacOS 12.0.1，and Windows 10 + CMake 3.19 + Visual Studio Community 2019.</p>
<p>Set CMake minimum requirement to 3.14</p>
<h4 id="Performance-Improvement："><a href="#Performance-Improvement：" class="headerlink" title="Performance Improvement："></a>Performance Improvement：</h4><p>Using C++ 11 rvalue reference/move semantics to mitigate the copy construction overhead, 5% speed improvement under large case<br>Using C++11 std::future, std::async for async function calls, with 5% improvement in speed.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define __THREADING__ </span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction" class="headerlink" title="Chapter 1: Introduction"></a>Chapter 1: Introduction</h2><p>Given M vertices, indexed from 1 to M, and N edges to represent a <strong>Directional Graph.</strong> </p>
<p>(In my implementation, both directional and undirectional graph works fine.)</p>
<p>To simplify the problem, the starting point is vertex 1 and the destination is vertex M.</p>
<h4 id="Task-Find-Out-the-Second-Shortest-Path"><a href="#Task-Find-Out-the-Second-Shortest-Path" class="headerlink" title="Task: Find Out the Second Shortest Path"></a>Task: Find Out the Second Shortest Path</h4><ul>
<li><strong>Allow Backtracking:</strong> means each vertex can be presented in the path more than once.<ul>
<li>e.g. Path: 1-&gt;2-&gt;1-&gt;3 is valid</li>
</ul>
</li>
<li><strong>Multiple Shortest Path:</strong> if multiple shortest path exists, the second shortest path is the one whose length is longer than those but no longer than any other path.<ul>
<li>e.g. The length of all possible paths are <strong>100,100,105,110.</strong> The second shortest path length is 105.</li>
<li>If two or more second shortest paths exist, any second shortest path would be accepted.</li>
</ul>
</li>
</ul>
<h3 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h3><p>In the first line specifies the <strong>number of vertices M and number of edges N of a digraph</strong>.</p>
<p>Then the rest N lines, each line is consisted of a edge, given by:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sourceVertex destVertex pathLength</span><br></pre></td></tr></table></figure>

<ul>
<li>Vertex is numbered from 1 to M</li>
<li>Only positive path length are considered</li>
</ul>
<h3 id="Constraints"><a href="#Constraints" class="headerlink" title="Constraints:"></a>Constraints:</h3><ul>
<li>$1\le M\le1000$</li>
<li>$1\le N\le5000$</li>
<li>$1\le pathLength\le1000$</li>
</ul>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint:"></a>Hint:</h3><ul>
<li>If(InputSize = 1000~10^6), a tolerable upper bound of an algorithm would be $O(nlog(n))$ </li>
<li>If(InputSize = 10^7), a tolerable upper bound of an algorithm would be $O(n)$</li>
<li>For this problem, if the <strong>input size is roughly $10^6&lt;$M*N</strong> $&lt;10^7$, the algorithm should be at least bounded by </li>
<li> $O(M<em>N log(M</em>N))$ .</li>
</ul>
<h3 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h3><p>Output the second shortest path in the form below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cost: cost</span><br><span class="line">Path: 1 ... m (exactly one space between each vertex, but no extra space at last)</span><br></pre></td></tr></table></figure>

<p>If there’s no second shortest path exist:</p>
<ul>
<li>Print a prompt to indicate there’s no second shortest path</li>
<li>Print the shortest path in the form below:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;But, the shortest path is&quot;</span><br><span class="line">Cost: cost</span><br><span class="line">Path: 1 ... m (exactly one space between each vertex, but no extra space at last)</span><br></pre></td></tr></table></figure>

<h3 id="Sample"><a href="#Sample" class="headerlink" title="Sample:"></a>Sample:</h3><ul>
<li>Input</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">50</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">100</span></span><br><span class="line"><span class="number">2</span> <span class="number">4</span> <span class="number">150</span></span><br><span class="line"><span class="number">3</span> <span class="number">4</span> <span class="number">130</span></span><br><span class="line"><span class="number">3</span> <span class="number">5</span> <span class="number">70</span></span><br><span class="line"><span class="number">4</span> <span class="number">5</span> <span class="number">40</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Output</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">240</span> <span class="number">1</span> <span class="number">2</span> <span class="number">4</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>



<h3 id="Related-Problems-and-Algorithms"><a href="#Related-Problems-and-Algorithms" class="headerlink" title="Related Problems and Algorithms:"></a>Related Problems and Algorithms:</h3><p>In general, this is an specialization of <strong>single source K Shortest Path Problem</strong> , where K=2.</p>
<p>Many different methods have been proposed to solve this problem, and there are two main variants of this problem:</p>
<blockquote>
<p>For DiGraph with M edges and N vertices:</p>
</blockquote>
<ul>
<li><strong>Loopy Variant, which means backtrack is allowed.</strong><ul>
<li>A solution was proposed by <strong>B. L. Fox in 1975</strong><ul>
<li>$O(m + kn*log (n))$ </li>
<li>Fox, B. L. (1975). “<em>K</em>th shortest paths and applications to the probabilistic networks”. <em><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Institute_for_Operations_Research_and_the_Management_Sciences">ORSA/TIMS Joint National Meeting</a></em>. <strong>23</strong>: B263. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/CiNii">CiNii National Article ID</a>: 10012857200.</li>
</ul>
</li>
<li>A faster approach was proposed by <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/David_Eppstein">David Eppstein</a><ul>
<li>$O(m + n*log (n)+k)$ </li>
<li> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/David_Eppstein">Eppstein, David</a> (1998). <a target="_blank" rel="noopener" href="https://www.ics.uci.edu/~eppstein/pubs/Epp-SJC-98.pdf">“Finding the <em>k</em> Shortest Paths”</a> (PDF). <em><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/SIAM_J._Comput.">SIAM J. Comput.</a></em> <strong>28</strong> (2): 652–673. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Doi_(identifier)">doi</a>:<a target="_blank" rel="noopener" href="https://doi.org/10.1137%2FS0097539795290477">10.1137/S0097539795290477</a></li>
<li>In this paper, he proposed that  if the shortest path tree (in the form of heap) is given, we can find the k-th shortest path in $O(m+n+k)$.</li>
</ul>
</li>
</ul>
</li>
<li>Loopless Variant, which means backtrack is not allowed.<ul>
<li>A well-known solution is called Yen’s algorithm<ul>
<li>$O(kn(m +n log (n)))$ </li>
<li> Yen, J. Y. (1971). “Finding the <em>k</em>-Shortest Loopless Paths in a Network”. <em><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Management_Science_(journal)">Management Science</a></em>. <strong>1 7</strong> (11): 712–716. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Doi_(identifier)">doi</a>:<a target="_blank" rel="noopener" href="https://doi.org/10.1287%2Fmnsc.17.11.712">10.1287/mnsc.17.11.712</a>..</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This problem, is the Loopy variant, which means an optimal time complexity can be achieved at  $O(n*log (n))$, which has a desirable run time with given constraints.</p>
<h3 id="Build-Environment-amp-To-Run"><a href="#Build-Environment-amp-To-Run" class="headerlink" title="Build Environment &amp; To Run:"></a>Build Environment &amp; To Run:</h3><h3 id="Building-Environment"><a href="#Building-Environment" class="headerlink" title="Building Environment:"></a>Building Environment:</h3><ul>
<li>MacOS 12.0.1</li>
<li>VSCode</li>
<li>Compiler: Clang ++ 13.0</li>
<li>C++ Standard = C++ 11</li>
<li>ARM64 Platform (Apple Silicon)</li>
</ul>
<h2 id="Approach-1-Recommended"><a href="#Approach-1-Recommended" class="headerlink" title="Approach 1(Recommended)"></a>Approach 1(Recommended)</h2><p>Using cmake for crossplatform compile</p>
<h3 id="Step1"><a href="#Step1" class="headerlink" title="Step1:"></a>Step1:</h3><p>Download and install cmake</p>
<h3 id="Step2"><a href="#Step2" class="headerlink" title="Step2:"></a>Step2:</h3><p>The Cmake instructions (CMakeLists.txt) has been provided. You can modify it yourself.</p>
<h3 id="Step3"><a href="#Step3" class="headerlink" title="Step3:"></a>Step3:</h3><p>Open terminal/Powershell</p>
<p>Type in command as below</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br><span class="line">./main #under macOS or Unix-like OS</span><br></pre></td></tr></table></figure>

<p>Now you’re running the program.</p>
<p>The program will output result carries out by each algorithm and their total runtime, in order of decreasing time complexity.</p>
<h2 id="Approach-2"><a href="#Approach-2" class="headerlink" title="Approach 2"></a>Approach 2</h2><p>Using VSCode C/C++ Extensions</p>
<h3 id="1-Modify-tasks-json-file"><a href="#1-Modify-tasks-json-file" class="headerlink" title="1.Modify tasks.json file:"></a>1.Modify tasks.json file:</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;-fdiagnostics-color=always&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-g&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-std=c++11&quot;</span>,</span><br><span class="line">                <span class="string">&quot;-o&quot;</span>,</span><br><span class="line">                <span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span></span><br><span class="line">            ],</span><br></pre></td></tr></table></figure>

<h3 id="2-Click-the-button-on-Run-and-Debug-panel"><a href="#2-Click-the-button-on-Run-and-Debug-panel" class="headerlink" title="2.Click the button on Run and Debug panel"></a>2.Click the button on Run and Debug panel</h3><h2 id="Other-IDE"><a href="#Other-IDE" class="headerlink" title="Other IDE:"></a>Other IDE:</h2><p>Import the source files, and set the C++ standard to C++11, better compile with Visual Studio 2019, or using Clang++.</p>
<h2 id="Known-Issue"><a href="#Known-Issue" class="headerlink" title="Known Issue:"></a>Known Issue:</h2><ul>
<li>GCC doesn’t support some C++ 11 features as of on Clang++, so if possible using clang++ instead.</li>
<li>When using Visual Studio 2019 for compiling, a largest case of 5000 edges would throw error of std::vector memory limit. However, this won’t happen when compile with clang++.</li>
</ul>
<h3 id="INPUT-MODE"><a href="#INPUT-MODE" class="headerlink" title="INPUT MODE:"></a>INPUT MODE:</h3><p>By default we set to <strong>__FILE_<em>INPUT</em>_</strong> And <strong>Looptime to 1.</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __FILE__INPUT__</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">change your loopTime here</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> loop</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> loopTime = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>USAGE ON MACROS:</p>
<ul>
<li>_SAMPLE_CASE_: The sample given by OJ.</li>
<li><em>FILE_INPUT</em>_: Get input from files.<ul>
<li>1 file case is provided to test the largest possible input.</li>
<li>of size M=1000, N=5000</li>
</ul>
</li>
<li>_USER_INPUT_: Get input from command line</li>
<li>Available Cases:<ul>
<li> _SAMPLE_CASE_1~6</li>
</ul>
</li>
<li>Available Graph Type:<ul>
<li>class DiGraph for directional graph</li>
<li>class UGraph for undirectional graph</li>
</ul>
</li>
</ul>
<h2 id="Chapter-2-Algorithm-Specification-Description"><a href="#Chapter-2-Algorithm-Specification-Description" class="headerlink" title="Chapter 2:    Algorithm Specification Description"></a>Chapter 2:    Algorithm Specification Description</h2><h3 id="Graph-Representation"><a href="#Graph-Representation" class="headerlink" title="Graph Representation:"></a>Graph Representation:</h3><p>We use the multiList representation of graph, meaning the multiList[i] indicates all the edges which starts from vertex i.</p>
<ul>
<li><p>Vertices on user interface level are numbered from 1 to n</p>
</li>
<li><p>Vertices in the multiList are numbered from 0 to n-1</p>
</li>
<li><p>Since variable sized array is available in C++, we don’t need linked list for the multiList implementation, using <strong>vector&lt;vector&lt;std::pair&lt;int,int&gt;&gt;&gt;</strong> instead. </p>
</li>
<li><p>In the std::pair, <strong>the first one indicates the destination vertex and the second indicates the path length (or cost).</strong></p>
</li>
<li><p>Type of the elements in the multiList:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span>(multiList) == vector&lt;vector&lt;std::pair&lt;<span class="built_in">int</span>,<span class="built_in">int</span>&gt;&gt;&gt; <span class="comment"># this full multiList</span></span><br><span class="line"><span class="built_in">type</span>(multiList[<span class="number">0</span>]) == vector&lt;std::pair&lt;<span class="built_in">int</span>,<span class="built_in">int</span>&gt;&gt; <span class="comment"># this is all edges starting from a certain vertex</span></span><br><span class="line"><span class="built_in">type</span>(multiList[<span class="number">0</span>][<span class="number">0</span>]) == std::pair&lt;<span class="built_in">int</span>,<span class="built_in">int</span>&gt; <span class="comment"># this is the single edge</span></span><br><span class="line">pair.first <span class="comment"># this is edge&#x27;s destination</span></span><br><span class="line">pair.second <span class="comment"># this is edge&#x27;s path length</span></span><br></pre></td></tr></table></figure></li>
<li><p>We implemented two types of graph, undirected graph and directed graph.</p>
<ul>
<li>They differs quite little in this implementation. A undirected graph, in this case, is a specialization of the directed graph.</li>
</ul>
</li>
<li><p>An API <strong>insertEdge()</strong> is implemented for edge insertion.</p>
</li>
</ul>
<h3 id="Check-Connection"><a href="#Check-Connection" class="headerlink" title="Check Connection:"></a>Check Connection:</h3><p>Before we start to find the second shortest path, we have to firstly check if there’s a possible path from <strong>vertex 1 to vertex m.</strong> We implemented this by Breadth-First-Search.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//keep a queue to store the vertices to be visited</span><br><span class="line">queue&lt;vertexNum&gt; adjVertices</span><br><span class="line">//keep a array to represent each vertices is visted or not</span><br><span class="line">visited&lt;bool&gt; isVisited</span><br><span class="line"></span><br><span class="line">enqueue the first vertex</span><br><span class="line"></span><br><span class="line">while(queue is not empty)</span><br><span class="line">    currentNode = dequeue()</span><br><span class="line">    if(currentNode is visited) </span><br><span class="line">    	continue;</span><br><span class="line">    mark the currentNode as visited;</span><br><span class="line">    enqueue the adjacent nodes of currentNode;</span><br></pre></td></tr></table></figure>

<p>After above process, we check if vertex m has been visited, if not, means there’s no possible path from vertex 1 to vertex m, abort.</p>
<blockquote>
<p>If vertex m has been visited, means there’s at least one path from vertex 1 to vertex m.</p>
<p>In this case, ShortestPath from 1 to m must exist.</p>
</blockquote>
<h3 id="Second-Shortest-Path"><a href="#Second-Shortest-Path" class="headerlink" title="Second Shortest Path:"></a>Second Shortest Path:</h3><p>In the Dijkstra’s algorithm, we find the shortest path by steps below:</p>
<ul>
<li><p>We keep an table, keeps track of each vertex’s <strong>shortest Path Length from Start</strong> and its direct predecessor of in shortest path.</p>
<ul>
<li><p>Each vertex is initialized as cost to infinity and predecessor to -1 as “Unmarked”</p>
</li>
<li><p>Each time visit the <strong>Unvisited Vertex Which Has The <mark>Shortest</mark> Path Length from Start</strong></p>
</li>
<li><p>Compute its neighbors’ cumulative Path Length, </p>
<pre><code>check if it’s shorter than the table’s records
if it&#39;s shorter, update table with the **path length and predecessor**
</code></pre>
</li>
<li><p>After compute, Mark the Vertex as visited.</p>
</li>
</ul>
</li>
<li><p>Dijkstra’s algorithm is an Greedy Algorithm, using local minimum to get global minimum.</p>
<ul>
<li>It’s possible to only record the direct predecessor of each vertex and be able to get the path from the table.<ul>
<li>The shortest path from vertex 1 to m is the global minimum, and each edge along this path is also the global minimum from vertex 1 to that vertex.</li>
</ul>
</li>
<li>An table may look like this</li>
</ul>
<img src="https://i.loli.net/2021/11/20/V2U9aNBSbvxOqH5.png" alt="image-20211120011014800" style="zoom: 33%;" /></li>
</ul>
<blockquote>
<p>Note that each step we have to find the <strong>Unvisited Vertex Which Has The <mark>Shortest</mark> Path Length from Start</strong>, If we do linear scan, the time complexity would be O(V^2). But if we keep a min heap, the time complexity would be O((V+E)log(E)).</p>
</blockquote>
<h3 id="Make-Some-Extension"><a href="#Make-Some-Extension" class="headerlink" title="Make Some Extension"></a>Make Some Extension</h3><p>To find the second shortest path, we simply keep another table, record the second shortest path from vertex 1 to vertex i. And we have to keep track of all of its predecessors <strong>(in implementation, a string)</strong>, instead of a single direct predecessor, since a second shortest path isn’t necessarily made up by multiple second shortest sub-paths.</p>
<p>We made some modification in the update part of the Dijkstra’s algorithm.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for v in adj(u):</span><br><span class="line">    if shortest[u] + cost(u, v) &lt; shortest[v]:</span><br><span class="line">        second_shortest[v] = shortest[v]</span><br><span class="line">        shortest[v] = shortest[u] + cost(u, v)</span><br><span class="line">    else if shortest[u] + cost(u, v) &lt; sec_shortest[v] and shortest[u]+cost(u,v)!=shortest[v]: //in case there are multiple shortest paths.</span><br><span class="line">            second_shortest[v] = shortest[u] + cost(u, v)</span><br></pre></td></tr></table></figure>

<p>Also, to allow backtracking, each node can be pushed on to min heap multiple times. But for the second shortest path, <strong>the node in such path can appear at most twice.</strong> </p>
<blockquote>
<p> This is obvious, if a path 1-&gt;3-&gt;1-&gt;2-&gt;1-&gt;4 contains a node appears more than twice  (1 appears 3 times), there must exist 2 shorter paths where vertex <strong>1 appear 1 and 2 times</strong> and reach 4, and thus it’s not a second shortest path.</p>
</blockquote>
<p>The overall pseudocode looks like below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">minHeap.push(vertex1)</span><br><span class="line"></span><br><span class="line">//break the loop if the heap is empty or the second shortest path has been calculated</span><br><span class="line">while(minHeap!=empty and second_shortest[vertexLast].cost == infinity)</span><br><span class="line">&#123;</span><br><span class="line">for v in adj(u):</span><br><span class="line">	if(v has been visited twice)</span><br><span class="line">		continue;</span><br><span class="line">    if shortest[u] + cost(u, v) &lt; shortest[v]:</span><br><span class="line">        second_shortest[v] = shortest[v]</span><br><span class="line">        shortest[v] = shortest[u] + cost(u, v)</span><br><span class="line">    else if shortest[u] + cost(u, v) &lt; sec_shortest[v] and shortest[u]+cost(u,v)!=shortest[v]: //in case there are multiple shortest paths.</span><br><span class="line">            second_shortest[v] = shortest[u] + cost(u, v)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><strong>If the second_shortest[vertexLast].cost=infinity, means there’s no second shortest path from vertex 1 to last vertex.</strong> In this case, we output the shortest path. A shortest path is ensured since we’ve done the BFS in advance.</p>
<h2 id="Chapter-3-Testing-Results"><a href="#Chapter-3-Testing-Results" class="headerlink" title="Chapter 3: Testing Results"></a>Chapter 3: Testing Results</h2><h4 id="Case-1-Sample-Case"><a href="#Case-1-Sample-Case" class="headerlink" title="Case 1: Sample Case"></a>Case 1: Sample Case</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">5</span>, <span class="number">6</span>)</span></span>;</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">50</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">100</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">150</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">130</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">5</span>, <span class="number">70</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">4</span>, <span class="number">5</span>, <span class="number">40</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Result-Correct"><a href="#Result-Correct" class="headerlink" title="Result: Correct"></a>Result: Correct</h4><img src="https://i.loli.net/2021/11/20/6bxgvMzEqNriWGX.png" alt="image-20211120014336249" style="zoom:67%;" />

<h4 id="Case-2-An-Undirectional-Graph"><a href="#Case-2-An-Undirectional-Graph" class="headerlink" title="Case 2: An Undirectional Graph"></a>Case 2: An Undirectional Graph</h4><img src="/Users/naoyuki/Library/Application%20Support/typora-user-images/image-20211120014537752.png" alt="image-20211120014537752" style="zoom: 50%;" />

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">UGraph <span class="title">graph</span><span class="params">(<span class="number">10</span>, <span class="number">11</span>)</span></span>;</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">7</span>, <span class="number">7</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">6</span>, <span class="number">8</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">7</span>, <span class="number">3</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">4</span>, <span class="number">8</span>, <span class="number">6</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">6</span>, <span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">7</span>, <span class="number">10</span>, <span class="number">4</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">8</span>, <span class="number">10</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Result-Correct-1"><a href="#Result-Correct-1" class="headerlink" title="Result: Correct"></a>Result: Correct</h4><img src="https://i.loli.net/2021/11/20/pXcBYEsFmk8xKGl.png" alt="image-20211120014515770" style="zoom:67%;" />



<h4 id="Case-3-Two-shortest-paths-exists-second-shortest-path-requires-backtracking"><a href="#Case-3-Two-shortest-paths-exists-second-shortest-path-requires-backtracking" class="headerlink" title="Case 3: Two shortest paths exists, second shortest path requires backtracking"></a>Case 3: Two shortest paths exists, second shortest path requires backtracking</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">UGraph <span class="title">graph</span><span class="params">(<span class="number">3</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Result-Correct-2"><a href="#Result-Correct-2" class="headerlink" title="Result: Correct"></a>Result: Correct</h4><img src="https://i.loli.net/2021/11/20/DefKAg2FdGR3LZo.png" alt="image-20211120014753271" style="zoom:67%;" />



<h4 id="Case-4-No-second-shortest-path-but-exist-two-shortest-path-of-same-length"><a href="#Case-4-No-second-shortest-path-but-exist-two-shortest-path-of-same-length" class="headerlink" title="Case 4: No second shortest path, but exist two shortest path of same length."></a>Case 4: No second shortest path, but exist two shortest path of same length.</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">3</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Result-Correct-3"><a href="#Result-Correct-3" class="headerlink" title="Result: Correct"></a>Result: Correct</h4><img src="https://i.loli.net/2021/11/20/PusOXbo5avM1pzN.png" alt="image-20211120014957572" style="zoom:67%;" />



<h4 id="Case-5-No-valid-path-from-1-to-m"><a href="#Case-5-No-valid-path-from-1-to-m" class="headerlink" title="Case 5: No valid path from 1 to m"></a>Case 5: No valid path from 1 to m</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">4</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Result-Correct-4"><a href="#Result-Correct-4" class="headerlink" title="Result: Correct"></a>Result: Correct</h4><p><img src="https://i.loli.net/2021/11/20/EncuRtsxgbwQ3dL.png" alt="image-20211120015142150"></p>
<h4 id="Case-6-Minimum-Case"><a href="#Case-6-Minimum-Case" class="headerlink" title="Case 6: Minimum Case"></a>Case 6: Minimum Case</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Minimum case, 2 vertices and 1 edge (since self loop is not allowed)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">2</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Result-Correct-5"><a href="#Result-Correct-5" class="headerlink" title="Result: Correct"></a>Result: Correct</h4><img src="https://i.loli.net/2021/11/20/elAFNhX43WD8HJV.png" alt="image-20211120132214734" style="zoom:67%;" />



<h4 id="Case-7-Maximum-Case"><a href="#Case-7-Maximum-Case" class="headerlink" title="Case 7: Maximum Case"></a>Case 7: Maximum Case</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Get input from largestCase.in</span></span><br><span class="line"><span class="comment">Use macro __FILE__INPUT__</span></span><br><span class="line"><span class="comment">m=1000,n=5000</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<img src="https://i.loli.net/2021/11/20/BOb8Rk12uQCMTKg.png" alt="image-20211120015529523"  />



<blockquote>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion:"></a>Conclusion:</h3><ul>
<li>The result seems acceptable so far, need some complex test cases for validation.</li>
</ul>
</blockquote>
<h2 id="Chapter-4-Analysis-and-Comments"><a href="#Chapter-4-Analysis-and-Comments" class="headerlink" title="Chapter 4:    Analysis and Comments"></a>Chapter 4:    Analysis and Comments</h2><ul>
<li>M = number of Vertices</li>
<li>N = number of Edges</li>
</ul>
<h3 id="1-Build-Graph"><a href="#1-Build-Graph" class="headerlink" title="1.Build Graph:"></a>1.Build Graph:</h3><p>We keep an multiList by inserting all edges into the vector&lt;vector&lt;pair&lt;int,int&gt;&gt;&gt;</p>
<ul>
<li>Each insertion takes $O(1)$, the overall time complexity would be $O(N)$</li>
</ul>
<h4 id="Overall-Time-Complexity-O-N"><a href="#Overall-Time-Complexity-O-N" class="headerlink" title="Overall Time Complexity: $O(N)$"></a>Overall Time Complexity: $O(N)$</h4><p>We keep an multiList, each element is consist of destination and cost, which is $O(1)$</p>
<p> the overall time complexity would be $O(N)$</p>
<h4 id="Overall-Space-Complexity-O-N"><a href="#Overall-Space-Complexity-O-N" class="headerlink" title="Overall Space Complexity: $O(N)$"></a>Overall Space Complexity: $O(N)$</h4><blockquote>
<p>For Undirectional Graph, the only difference is that the insertion time and space taken by undirectional graph is twice as the directional one. But both are O(N) after all.</p>
</blockquote>
<h3 id="2-Check-Connection"><a href="#2-Check-Connection" class="headerlink" title="2.Check Connection:"></a>2.Check Connection:</h3><ol>
<li>In this step each edge is visited at most once, each node is visited at most once.</li>
<li>The enqueue and dequeue takes $O(1)$ time.</li>
</ol>
<p> the overall time complexity would be $O(N)$</p>
<h4 id="Overall-Time-Complexity-O-M-N"><a href="#Overall-Time-Complexity-O-M-N" class="headerlink" title="Overall Time Complexity: $O(M+N)$"></a>Overall Time Complexity: $O(M+N)$</h4><h4 id="Space-Complexity"><a href="#Space-Complexity" class="headerlink" title="Space Complexity :"></a>Space Complexity :</h4><p>A queue of $O(N)$ (at most contains all edges) is needed in this step.</p>
<h4 id="Overall-Space-Complexity-O-N-1"><a href="#Overall-Space-Complexity-O-N-1" class="headerlink" title="Overall Space Complexity: $O(N)$"></a>Overall Space Complexity: $O(N)$</h4><h3 id="3-Second-Shortest-Path"><a href="#3-Second-Shortest-Path" class="headerlink" title="3.Second Shortest Path"></a>3.Second Shortest Path</h3><ul>
<li><p>We push each node to min heap at most twice (2M)</p>
<ul>
<li><p>Each time a edge is popped</p>
<ul>
<li>We update table, which takes $O(1)$ time</li>
</ul>
</li>
<li><p>Each pop or push takes $O(log(M))$ time</p>
</li>
</ul>
</li>
</ul>
<h4 id="Overall-Time-Complexity-O-Mlog-M"><a href="#Overall-Time-Complexity-O-Mlog-M" class="headerlink" title="Overall Time Complexity: $O(Mlog(M))$"></a>Overall Time Complexity: $O(Mlog(M))$</h4><ul>
<li><p>We keep two tables, each tables takes M elements, each elements contains a string (contains all predecessors, at most length O(N)) and a int (cumulative cost).</p>
<ul>
<li>Two tables occupies $O(2M*N)$ Space.</li>
</ul>
</li>
<li><p>We also keeps an heap of max size $O(N)$, each node occupies $O(1)$ Space.</p>
</li>
</ul>
<h4 id="Overall-Space-Complexity-O-M-N"><a href="#Overall-Space-Complexity-O-M-N" class="headerlink" title="Overall Space Complexity:  $O(M*N)$"></a>Overall Space Complexity:  $O(M*N)$</h4><h3 id="OVERALL"><a href="#OVERALL" class="headerlink" title="OVERALL:"></a>OVERALL:</h3><h4 id="Overall-Time-Complexity-O-N-Mlog-M"><a href="#Overall-Time-Complexity-O-N-Mlog-M" class="headerlink" title="Overall Time Complexity: $O(N+Mlog(M))$"></a>Overall Time Complexity: $O(N+Mlog(M))$</h4><h4 id="Overall-Space-Complexity-O-M-N-1"><a href="#Overall-Space-Complexity-O-M-N-1" class="headerlink" title="Overall Space Complexity:  $O(M*N)$"></a>Overall Space Complexity:  $O(M*N)$</h4><h3 id="Comments"><a href="#Comments" class="headerlink" title="Comments:"></a>Comments:</h3><blockquote>
<p>In the actual implementation of the constraint “each node is visited at most twice”, we use a slightly different approach based on the cumulative length, but they should have the same effect.</p>
<p>Although no hacking cases founded now, if things go wrong in some cases, the logic there needs a rewrite to be more accurate.</p>
</blockquote>
<h3 id="Extra-K-Shortest-Path"><a href="#Extra-K-Shortest-Path" class="headerlink" title="Extra: K-Shortest Path"></a>Extra: K-Shortest Path</h3><p>If we extend the same technique to  the K shortest path, we have to keep K table, which takes up $O(K<em>M</em>N)$ Space.</p>
<p>Each node can be pushed to heap at most K times, Which takes overall $O(N + K<em>M</em>log (M))$ time.</p>
<h4 id="Overall-Time-Complexity-O-N-K-Mlog-M"><a href="#Overall-Time-Complexity-O-N-K-Mlog-M" class="headerlink" title="Overall Time Complexity: $O(N+K*Mlog(M))$"></a>Overall Time Complexity: $O(N+K*Mlog(M))$</h4><h4 id="Overall-Space-Complexity-O-KMN"><a href="#Overall-Space-Complexity-O-KMN" class="headerlink" title="Overall Space Complexity:  $$O(KMN)$$"></a>Overall Space Complexity:  $$O(K<em>M</em>N)$$</h4><h2 id="Appendix-Source-Code-in-C-11"><a href="#Appendix-Source-Code-in-C-11" class="headerlink" title="Appendix:    Source Code (in C++11)"></a>Appendix:    Source Code (in C++11)</h2><h4 id="Djikstra-hpp"><a href="#Djikstra-hpp" class="headerlink" title="Djikstra.hpp"></a>Djikstra.hpp</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Graph.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">anscestors are numbered from 0~n-1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CostTable</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> cost;</span><br><span class="line">    string ancestors;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">heap node is numbered from 1~n</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HeapNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    string ancestors;</span><br><span class="line">    <span class="keyword">int</span> src;</span><br><span class="line">    <span class="keyword">int</span> dst;</span><br><span class="line">    <span class="keyword">int</span> cost;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">HeapNode</span>(string&amp;&amp; ancestors, <span class="keyword">int</span> src, <span class="keyword">int</span> dst, <span class="keyword">int</span> cost)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;ancestors = ancestors;</span><br><span class="line">        <span class="keyword">this</span>-&gt;src = src;</span><br><span class="line">        <span class="keyword">this</span>-&gt;dst = dst;</span><br><span class="line">        <span class="keyword">this</span>-&gt;cost = cost;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Order minHeap by cost</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">compare</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> HeapNode &amp;a, <span class="keyword">const</span> HeapNode &amp;b)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a.cost &gt; b.cost;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Allowing for both digraph and undirectional graphs.</span></span><br><span class="line"><span class="comment">finding the second shortest path using extended dijkstra algorithm</span></span><br><span class="line"><span class="comment">graph: the graph to be searched</span></span><br><span class="line"><span class="comment">verbose: print out result, by default set to true</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(T &amp;graph, <span class="keyword">bool</span> verbose = <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    type check</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">bool</span> isGraph = std::is_same&lt;T, UGraph&gt;::value || std::is_same&lt;T, DiGraph&gt;::value;</span><br><span class="line">    <span class="keyword">if</span> (!isGraph)</span><br><span class="line">        <span class="keyword">throw</span> std::<span class="built_in">runtime_error</span>(<span class="string">&quot;Input is not compatible graph&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    initialize the table,</span></span><br><span class="line"><span class="comment">    with the total path cost to inifinity,</span></span><br><span class="line"><span class="comment">    parent to - 1 as null</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">   record the shortest path cost</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">    <span class="function">vector&lt;CostTable&gt; <span class="title">costTable</span><span class="params">(graph.getVertexNum(), &#123;INT32_MAX, &#123;<span class="string">&quot;-1&quot;</span>&#125;&#125;)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">   record the second shortest path cost</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">    <span class="function">vector&lt;CostTable&gt; <span class="title">secondCostTable</span><span class="params">(graph.getVertexNum(), &#123;INT32_MAX, &#123;<span class="string">&quot;-1&quot;</span>&#125;&#125;)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//initialize priority_queue as minHeap. STL implementation by default is maxHeap</span></span><br><span class="line">    priority_queue&lt;HeapNode, vector&lt;HeapNode&gt;, compare&gt; minHeap;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//set starting point</span></span><br><span class="line">    costTable[<span class="number">0</span>].ancestors = <span class="string">&quot;-2&quot;</span>;</span><br><span class="line">    costTable[<span class="number">0</span>].cost = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    priority_queue doesn&#x27;t offer a iterator</span></span><br><span class="line"><span class="comment">    each node contains source, destination and cumulative cost</span></span><br><span class="line"><span class="comment">    order by cumulative cost</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//push the adjacent nodes of the starting node</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;edge : graph.multiList[<span class="number">0</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> tmpNode = <span class="built_in">HeapNode</span>(<span class="string">&quot;1 &quot;</span> + <span class="built_in">to_string</span>(edge.first + <span class="number">1</span>), <span class="number">1</span>, edge.first + <span class="number">1</span>, edge.second);</span><br><span class="line">        minHeap.<span class="built_in">push</span>(tmpNode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    while the second shortest path of the given vertex is not determined</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">while</span> (!minHeap.<span class="built_in">empty</span>() &amp;&amp; secondCostTable.<span class="built_in">back</span>().cost == INT32_MAX)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> node = minHeap.<span class="built_in">top</span>();</span><br><span class="line">        minHeap.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> totalCost = node.cost;</span><br><span class="line">        <span class="keyword">int</span> srcIndex = node.src;</span><br><span class="line">        <span class="keyword">int</span> destIndex = node.dst;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">    if the current node&#x27;s total cost is less than the cost in shortest table</span></span><br><span class="line"><span class="comment">    update the shortest path, and the second shortest path</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">        <span class="keyword">if</span> (totalCost &lt; costTable[destIndex - <span class="number">1</span>].cost)</span><br><span class="line">        &#123;</span><br><span class="line">            secondCostTable[destIndex - <span class="number">1</span>].cost = costTable[destIndex - <span class="number">1</span>].cost;</span><br><span class="line">            secondCostTable[destIndex - <span class="number">1</span>].ancestors = costTable[destIndex - <span class="number">1</span>].ancestors;</span><br><span class="line">            costTable[destIndex - <span class="number">1</span>].cost = totalCost;</span><br><span class="line">            costTable[destIndex - <span class="number">1</span>].ancestors = node.ancestors;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">    if the current node&#x27;s total cost is larger than the shortest</span></span><br><span class="line"><span class="comment">    and less than the cost in second shortest </span></span><br><span class="line"><span class="comment">    update the second shortest path</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (totalCost &lt; secondCostTable[destIndex - <span class="number">1</span>].cost &amp;&amp; totalCost != costTable[destIndex - <span class="number">1</span>].cost)</span><br><span class="line">        &#123;</span><br><span class="line">            secondCostTable[destIndex - <span class="number">1</span>].cost = totalCost;</span><br><span class="line">            secondCostTable[destIndex - <span class="number">1</span>].ancestors = node.ancestors;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123; <span class="comment">//to find the 2nd shortest path</span></span><br><span class="line">            <span class="comment">// there&#x27;s no need to push the child of 3rd or 4th shortest path to heap</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">    push the adjacent nodes, we don&#x27;t check if the node is visited or not</span></span><br><span class="line"><span class="comment">    since we allow backtracking</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;edge : graph.multiList[destIndex - <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            each node is ensured to be visited twice at most</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">if</span> (secondCostTable[edge.first].cost &lt; totalCost + edge.second)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//push the node to the priority queue</span></span><br><span class="line">            <span class="keyword">auto</span> tmpNode = <span class="built_in">HeapNode</span>(node.ancestors + <span class="string">&quot; &quot;</span> + <span class="built_in">to_string</span>(edge.first + <span class="number">1</span>), destIndex, edge.first + <span class="number">1</span>, totalCost + edge.second);</span><br><span class="line">            minHeap.<span class="built_in">push</span>(tmpNode);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    if the ancestors is &quot;-1&quot;, means the second cost table of the last vertex</span></span><br><span class="line"><span class="comment">    haven&#x27;t been visited yet, Which means there&#x27;s no second shortest path, but at least one path</span></span><br><span class="line"><span class="comment">    from start to end is ensured through previous checkConnection().</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (secondCostTable.<span class="built_in">back</span>().ancestors == <span class="string">&quot;-1&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (verbose)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Doesn&#x27;t exist second shortest path.&quot;</span> &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;But, the shortest path is&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> cost = costTable.<span class="built_in">back</span>().cost;</span><br><span class="line">        <span class="keyword">auto</span> path = costTable.<span class="built_in">back</span>().ancestors;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (verbose)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Cost: &quot;</span> &lt;&lt; cost &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Path: &quot;</span>;</span><br><span class="line">            cout &lt;&lt; path &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    return the second shortest path with given cost table</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (verbose)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;The second shortest path is&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cost = secondCostTable.<span class="built_in">back</span>().cost;</span><br><span class="line">    <span class="keyword">auto</span> path = secondCostTable.<span class="built_in">back</span>().ancestors;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (verbose)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Cost: &quot;</span> &lt;&lt; cost &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Path: &quot;</span>;</span><br><span class="line">        cout &lt;&lt; path &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Graph-hpp"><a href="#Graph-hpp" class="headerlink" title="Graph.hpp"></a>Graph.hpp</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Base Class</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Graph</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//multiList Representation, using vector</span></span><br><span class="line">    <span class="comment">//each element contains destination and cost</span></span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;&gt; multiList;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Graph</span>()&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//initialize</span></span><br><span class="line">    <span class="built_in">Graph</span>(<span class="keyword">int</span> vertexNum, <span class="keyword">int</span> edgeNum)</span><br><span class="line">    &#123;</span><br><span class="line">        vNum = vertexNum;</span><br><span class="line">        eNum = edgeNum;</span><br><span class="line">        multiList.<span class="built_in">resize</span>(vertexNum);</span><br><span class="line">        inDegree.<span class="built_in">resize</span>(vertexNum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//get number of vertices</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getVertexNum</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//get number of vertices</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getEdgeNum</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> eNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    insert an edge from src to dst</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">insertEdge</span><span class="params">(<span class="keyword">int</span> srcVertex, <span class="keyword">int</span> dstVertex, <span class="keyword">int</span> cost)</span> </span>= <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">containsEdge</span><span class="params">(<span class="keyword">int</span> srcVertex, <span class="keyword">int</span> dstVertex)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// make it easier to index</span></span><br><span class="line">        <span class="keyword">int</span> src = srcVertex - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> dst = dstVertex - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//check if the graph contains a certain edge, using lambda expression</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find_if</span>(multiList[src].<span class="built_in">begin</span>(), multiList[src].<span class="built_in">end</span>(), [&amp;](<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &amp;elem)</span><br><span class="line">                    &#123; <span class="keyword">return</span> elem.first == dst; &#125;) != multiList[src].<span class="built_in">end</span>())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; multiList.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; multiList[i].<span class="built_in">size</span>(); j++)</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; multiList[i][j].first + <span class="number">1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; multiList[i][j].second &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cout &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; inDegree;</span><br><span class="line">    <span class="comment">//number of edges and vertices</span></span><br><span class="line">    <span class="keyword">int</span> vNum;</span><br><span class="line">    <span class="keyword">int</span> eNum;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">a class for undirectional graphs</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UGraph</span> :</span> <span class="keyword">public</span> Graph</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">UGraph</span>(<span class="keyword">int</span> vNum, <span class="keyword">int</span> eNum) : <span class="built_in">Graph</span>(vNum, eNum)&#123;&#125;;</span><br><span class="line">    <span class="comment">//insert an edge from src to dst</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertEdge</span><span class="params">(<span class="keyword">int</span> srcVertex, <span class="keyword">int</span> dstVertex, <span class="keyword">int</span> cost)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// minus one, make it easier to index</span></span><br><span class="line">        <span class="keyword">int</span> src = srcVertex - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> dst = dstVertex - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//update parameters</span></span><br><span class="line">        multiList[src].<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(dst, cost));</span><br><span class="line">        multiList[dst].<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(src, cost));</span><br><span class="line">        inDegree[dst]++;</span><br><span class="line">        inDegree[src]++;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">a class for Directional graphs</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DiGraph</span> :</span> <span class="keyword">public</span> Graph</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">DiGraph</span>(<span class="keyword">int</span> vNum, <span class="keyword">int</span> eNum) : <span class="built_in">Graph</span>(vNum, eNum)&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//insert an edge from src to dst</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertEdge</span><span class="params">(<span class="keyword">int</span> srcVertex, <span class="keyword">int</span> dstVertex, <span class="keyword">int</span> cost)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// minus one, make it easier to index</span></span><br><span class="line">        <span class="keyword">int</span> src = srcVertex - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> dst = dstVertex - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//update parameters</span></span><br><span class="line">        multiList[src].<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(dst, cost));</span><br><span class="line">        inDegree[dst]++;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">BFS algorithm to check if there&#x27;s a path from the first node to the last node</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">checkConnection</span><span class="params">(T &amp;graph)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    type check</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">bool</span> isGraph = std::is_same&lt;T, UGraph&gt;::value || std::is_same&lt;T, DiGraph&gt;::value;</span><br><span class="line">    <span class="keyword">if</span> (!isGraph)</span><br><span class="line">        <span class="keyword">throw</span> std::<span class="built_in">runtime_error</span>(<span class="string">&quot;Input is not compatible graph&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">bool</span>&gt; <span class="title">isVisited</span><span class="params">(graph.getVertexNum(), <span class="literal">false</span>)</span></span>;</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    push in the first node</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    q.<span class="built_in">push</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    each round:</span></span><br><span class="line"><span class="comment">    1.currentNode = dequeue(), if(currentNode is visited) continue;</span></span><br><span class="line"><span class="comment">    2.mark the currentNode as visited.</span></span><br><span class="line"><span class="comment">    3.enqueue the adjacent nodes of currentNode</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">int</span> currentNode;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        currentNode = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isVisited[currentNode])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        isVisited[currentNode] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;adjNode : graph.multiList[currentNode])</span><br><span class="line">        &#123;</span><br><span class="line">            q.<span class="built_in">push</span>(adjNode.first);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    if there&#x27;s no path from the first node to the last node</span></span><br><span class="line"><span class="comment">    means there&#x27;s no possible second shortest path</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (!isVisited[graph.<span class="built_in">getVertexNum</span>() - <span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;ERROR: No Path to Destination&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="lab3-cpp"><a href="#lab3-cpp" class="headerlink" title="lab3.cpp"></a>lab3.cpp</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Graph.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Dijkstra.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;future&gt;</span></span></span><br><span class="line"><span class="comment">// #define __SAMPLE__CASE__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __CASE__2__</span></span><br><span class="line"><span class="comment">// #define __USER__INPUT__</span></span><br><span class="line"><span class="comment">// #define __FILE__INPUT__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __THREADING__</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">change your loopTime here</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> loop</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> loopTime = <span class="number">10000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __SAMPLE__CASE__</span></span><br><span class="line">    <span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">5</span>, <span class="number">6</span>)</span></span>;</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">50</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">100</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">150</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">130</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">5</span>, <span class="number">70</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">4</span>, <span class="number">5</span>, <span class="number">40</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">a bidirectional (undirected graph) case</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __CASE__1__</span></span><br><span class="line">    <span class="function">UGraph <span class="title">graph</span><span class="params">(<span class="number">10</span>, <span class="number">11</span>)</span></span>;</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">7</span>, <span class="number">7</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">6</span>, <span class="number">8</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">7</span>, <span class="number">3</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">4</span>, <span class="number">8</span>, <span class="number">6</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">6</span>, <span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">7</span>, <span class="number">10</span>, <span class="number">4</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">8</span>, <span class="number">10</span>, <span class="number">2</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">there exist two shortest path between 1-3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __CASE__2__</span></span><br><span class="line">    <span class="function">UGraph <span class="title">graph</span><span class="params">(<span class="number">3</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Only one shortest path between 1 and 3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __CASE__3__</span></span><br><span class="line">    <span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">3</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Vertex 4 is isolated, no valid path</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __CASE__4__</span></span><br><span class="line">    <span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">4</span>, <span class="number">3</span>)</span></span>;</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Minimum case, 2 vertices and 1 edge (since self loop is not allowed)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __CASE__5__</span></span><br><span class="line">    <span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">2</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">DiGraph with cycle</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __CASE__6__</span></span><br><span class="line">    <span class="function">DiGraph <span class="title">graph</span><span class="params">(<span class="number">5</span>, <span class="number">5</span>)</span></span>;</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">100</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">100</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">100</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>);</span><br><span class="line">    graph.<span class="built_in">insertEdge</span>(<span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __FILE__INPUT__</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    a large input case</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">std::ifstream <span class="title">inputFile</span><span class="params">(<span class="string">&quot;largestCase.in&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> vNum, eNum;</span><br><span class="line">    inputFile &gt;&gt; vNum &gt;&gt; eNum;</span><br><span class="line">    <span class="function">DiGraph <span class="title">graph</span><span class="params">(vNum, eNum)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> src, dst, cost;</span><br><span class="line">    <span class="keyword">while</span> (eNum &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        inputFile &gt;&gt; src &gt;&gt; dst &gt;&gt; cost;</span><br><span class="line">        graph.<span class="built_in">insertEdge</span>(src, dst, cost);</span><br><span class="line">        eNum--;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">get input from user, by default directional graph</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __USER__INPUT__</span></span><br><span class="line">    <span class="keyword">int</span> vNum, eNum;</span><br><span class="line">    cin &gt;&gt; vNum &gt;&gt; eNum;</span><br><span class="line">    <span class="function">DiGraph <span class="title">graph</span><span class="params">(vNum, eNum)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> src, dst, cost;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; graph.<span class="built_in">getEdgeNum</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; src &gt;&gt; dst &gt;&gt; cost;</span><br><span class="line">        graph.<span class="built_in">insertEdge</span>(src, dst, cost);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    std::chrono::time_point&lt;std::chrono::system_clock&gt; start, end;</span><br><span class="line">    start = std::chrono::system_clock::<span class="built_in">now</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; loop::loopTime; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//using async function</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __THREADING__</span></span><br><span class="line">        std::future&lt;<span class="keyword">bool</span>&gt; fp = <span class="built_in">async</span>(</span><br><span class="line">            launch::async, checkConnection&lt;<span class="keyword">decltype</span>(graph)&gt;,</span><br><span class="line">            std::<span class="built_in">ref</span>(graph));</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __THREADING__</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">checkConnection</span>(graph))</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">dijkstra</span>(graph, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __THREADING__</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">bool</span> isConnected = fp.<span class="built_in">get</span>();</span><br><span class="line">            <span class="keyword">if</span> (!isConnected)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in"><span class="keyword">catch</span></span> (std::exception &amp;e)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Error: threading failed:&quot;</span> &lt;&lt; e.<span class="built_in">what</span>() &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::chrono::duration&lt;<span class="keyword">double</span>&gt; duration;</span><br><span class="line">    end = std::chrono::system_clock::<span class="built_in">now</span>();</span><br><span class="line">    duration = end - start;</span><br><span class="line">    <span class="comment">//print time it takes</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Program Completed in: &quot;</span> &lt;&lt; duration.<span class="built_in">count</span>() &lt;&lt; <span class="string">&quot; seconds&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    test code for graph functionality</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; graph.containsEdge(1, 2) &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">// graph.print();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://music.163.com/song/media/outer/url?id=430224.mp3"></li>
                        
                    
                </ul>
            
        </div>
        <div id="gitalk-container" class="comment link">加载评论</div>
    </div>
    
</div>


    </div>
</div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"scale":1.1,"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"vOffset":-100,"position":"right","width":200,"height":400},"mobile":{"show":false},"react":{"opacity":0.7}});</script></body>

    
<script src="/js/Valine.min.js"></script>

        
            
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>

                
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




</html>
